//DB Connection

MongoClient.connect(
  DBurl,
  function (err, db) {
    //DBnamnet
    var dbo = db.db("ingreds");
    console.log("We are connected");
    db.close();
  }
);
    
    
    
    //allt i databasen till en lista (results)
    
    //tabellnamnet
    // dbo
    //   .collection("ingreds")
    //   .find({})
    //   .toArray(function (err, result) {
    //     if (err) {
    //       throw err;
    //     }
    //     console.log(result);

    //   });



    //Lägger in hela json filen i databasen

         dbo.collection("ingreds").insertMany(ldata, function (err, res) {
       console.log("Number of documents inserted: " + res.insertedCount);
     });



// Connect to the db
//Hittar i databasen efter nummer och lägger till i en lista
MongoClient.connect(DBurl, function(err, db) {
  if (err) throw err;
  var dbo = db.db("ingreds");

  //Hitta object efter Nummer
   dbo.collection("ingreds").find({Nummer: "666"}).toArray(function(err, result) {
    if (err) throw err;

    app.get("/one-item", (req, res) => {
      res.json(result[0]);
    });
   // console.log(result);
    db.close();
  });
});



//Hur många items ska visas?
app.get('/item/:Nummer', function(req, res) {

 // res.send("tagId is set to " + req.params.Nummer);
  res.json(ldata.slice(0, req.params.Nummer));
 // console.log(result);
});




//Sök json efter nummer
app.get('/item/:Nummer', function(req, res) {
 // res.send("tagId is set to " + req.params.Nummer);
  res.json(ldata[req.params.Nummer-1].Namn);
 // console.log(result);
});



//Hittar i databasen efter parametern Nummer i urlen
app.get('/item/:Nummer', function(req, res) {
 MongoClient.connect(DBurl, function(err, db) {
  if (err) throw err;
  var dbo = db.db("ingreds");
  //Hitta object efter Nummer
  dbo.collection("ingreds").findOne({Nummer: req.params.Nummer}, function(err, result) {
    if (err) throw err;
    console.log(result);
    db.close();
  });
});
});


//Sök databas efter nummer
app.get('/item/:Nummer', function (req, res) {
  MongoClient.connect(DBurl, function (err, db) {
    if (err) throw err;
    var dbo = db.db("ingreds");

    //Hitta object efter Nummer
    dbo.collection("ingreds").findOne({
      Nummer: req.params.Nummer
    }, function (err, result) {
      if (err) throw err;
      res.json(result)
      db.close();
    });
  });
});



//Mongoos-kod att komma igåg hur det funkar 
var mongoose = require('mongoose');
mongoose.connect('mongodb://localhost:27017/ingreds');

var db = mongoose.connection;
db.on('error', console.error.bind(console, 'connection error:'));
db.once('open', function() {
  // we're connected!
  console.log('connected to mongoose shity fuck')
});

var ingNameSchema = new mongoose.Schema({
  Namn: String,
});

var Ing = mongoose.model('ing', ingNameSchema);

var hök = new Ing({ Namn: 'Hök' });
console.log(hök.Namn); // 'Silence'

hök.save()

Ing.find({Namn: 'grgr'},function(err, ings){
  if (err) {console.error(err);}

  console.log('hittade höken', ings);
  
});

This performs a search for all documents with a name property that begins with "Fluff" and returns the result as an array of kittens to the callback.v
Kitten.find({ name: /^fluff/ }, callback);